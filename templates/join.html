{% extends "base.html" %}
{% block content %}
<script type="text/javascript">
    $(document).ready(function() {
        var hMan = new Hangman(document.getElementById("holder"));
        var handler = new EventHandler(hMan, $('div#status'), $('div#word-state'), function(data) {
            switch(data.status) {
                case "over-success":
                case "over-failed":
                    $('#letters').remove();
                    break;
            }
        });
        setTimeout(function(){
            var sub = new Subscription(handler.handlers);
            sub.subscribe('/subscribe?id={{channel_id}}');
            $.getJSON('/api/game/join/{{channel_id}}', function(data) {
                $('[class^="letter"]').click(function(ev) {
                    ev.preventDefault();
                    $('#letters').toggle();
                    var letterElem = $(this);
                    $.getJSON('/api/game/guess/{{channel_id}}/' + letterElem.html(), function(data){
                        letterElem.remove();
                        $('#letters').toggle();
                    });
                });
            });
        }, 500);
    });
</script>
<div id="letters">
{% for letter in letters %}
    <span><a href="" id="letter-{{letter}}" class="letter">{{letter}}</a></span>
{% endfor %}
</div>
{% endblock %}
